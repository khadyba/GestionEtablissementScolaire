{
    "sourceFile": "app/Http/Controllers/EtablissementController.php",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1727022424051,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1727022424051,
            "name": "Commit-0",
            "content": "<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Http\\Request;\nuse App\\Models\\Etablissement;\nuse Illuminate\\Support\\Facades\\Auth;\n\nclass EtablissementController extends Controller\n{\n    /**\n     * Display a listing of the resource.\n     *\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function index()\n    {\n    //    \n    }\n\n    /**\n     * Show the form for creating a new resource.\n     *\n     * @return \\Illuminate\\Http\\Response\n     */\n    // public function create()\n    // {\n    //     return view('Administrateur.etablissementFormulaire');\n    // }\n    public function create()\n{\n    $administrateur = auth()->user();\n    $etablissementExist = $administrateur->etablissement;\n    if (!$etablissementExist) {\n        return redirect()->route('admin.dashboard')->with('error', 'Vous avez déjà ajouté un établissement.');\n    }\n    return view('Administrateur.etablissementFormulaire');\n}\n    /**\n     * Store a newly created resource in storage.\n     *\n     * @param  \\Illuminate\\Http\\Request  $request\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function store(Request $request)\n    {\n       \n        $administrateur = Auth::guard('admin')->user();\n        $validatedData = $request->validate([\n            'nom' => 'required|string|max:255',\n            'directeur' => 'required|string|max:255',\n            'adresse' => 'required|string|max:255',\n            'telephone' => 'required|string|max:20',\n            'email' => 'required|email|max:255',\n            'type' => 'required|string|max:50',\n        ]);\n        $etablissement = Etablissement::create([\n            'nom' => $validatedData['nom'],\n            'directeur' => $validatedData['directeur'],\n            'adresse' => $validatedData['adresse'],\n            'telephone' => $validatedData['telephone'],\n            'email' => $validatedData['email'],\n            'type' => $validatedData['type'],\n            'administrateur_id' => $administrateur->id, \n        ]);\n        return redirect()->route('admin.dashboard')->with('success', 'Établissement ajouté avec succès.');\n    }\n    \n\n    /**\n     * Display the specified resource.\n     *\n     * @param  \\App\\Models\\Etablissement  $etablissement\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function show(Etablissement $etablissement)\n    {\n        //\n    }\n\n    /**\n     * Show the form for editing the specified resource.\n     *\n     * @param  \\App\\Models\\Etablissement  $etablissement\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function edit(Etablissement $etablissement)\n    {\n        //\n    }\n\n    /**\n     * Update the specified resource in storage.\n     *\n     * @param  \\Illuminate\\Http\\Request  $request\n     * @param  \\App\\Models\\Etablissement  $etablissement\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function update(Request $request, Etablissement $etablissement)\n    {\n        //\n    }\n\n    /**\n     * Remove the specified resource from storage.\n     *\n     * @param  \\App\\Models\\Etablissement  $etablissement\n     * @return \\Illuminate\\Http\\Response\n     */\n    public function destroy(Etablissement $etablissement)\n    {\n        //\n    }\n}\n"
        }
    ]
}